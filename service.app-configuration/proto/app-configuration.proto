syntax = "proto3";

package config_proto;

option go_package = "github.com/KonstantinGasser/datalab/service.app-configuration/proto";

import "common/common.proto";

service AppConfiguration {
    rpc Init(InitRequest) returns (InitResponse) {}
    rpc Get(GetRequest) returns (GetResponse) {}
    rpc Update(UpdateRequest) returns (UpdateResponse) {}
    rpc HasConfigs(HasConfigsRequest) returns (HasConfigsResponse) {}
}


message InitRequest {
    string tracing_ID = 1;
    string for_app = 2;
}
message InitResponse {
    int32 status_code = 1;
    string msg = 2;
    string UUID = 3;
}

message GetRequest {
    string tracing_ID = 1;
    string for_uuid = 2;
}
message GetResponse {
    int32 status_code = 1;
    string msg = 2;
    common.ConfigInfo configs = 3;
}

message HasConfigsRequest {
    string tracing_ID = 1;
    string UUID = 2;
}
message HasConfigsResponse {
    int32 status_code = 1;
    string msg = 2;
    bool ok = 3;
}

message UpdateRequest {
    string tracing_ID = 1;
    string UUID =  2;
    string update_flag = 3;
    repeated common.Funnel stages = 4;
    repeated common.Campaign records = 5;
    repeated common.BtnTime btn_defs = 6;
}
message Funnel {
    int32 id = 1;
    string name = 2;
    string transition = 3;
}
message Campaign {
    int32 id = 1;
    string name = 2;
    string prefix = 3;
}
message BtnTime {
    int32 id = 1;
    string name = 2;
    string btn_name = 3;
}
message UpdateResponse {
    int32 status_code = 1;
    string msg = 2;
}
